<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BoundingBox.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">termProject</a> &gt; <a href="index.source.html" class="el_package">database</a> &gt; <span class="el_source">BoundingBox.java</span></div><h1>BoundingBox.java</h1><pre class="source lang-java linenums">package database;

import attractions.Museum;
import attractions.Park;
import attractions.Restaurant;
import attractions.Shop;
import edu.brown.cs.student.termProject.AttractionNode;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.ProtocolException;
import java.net.URL;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

/**
 * Class with static functions to find all the attractions within a bounding box
 * around two sets of coordinates.
 */
<span class="nc" id="L28">public class BoundingBox {</span>


  /**
   * Creates a bounding box around the given starting and end positions,
   * and returns a list of the AttractionNodes from the yelp-database within
   * this box that are of the given categories.
   *
   * @param coords1 - [lat, lon] of the start position
   * @param coords2 - [lat, lon] of the end position
   * @param categories - list of acceptable attraction categories
   * @param prefNumStops - number of stops user prefers to make
   * @param costPref - cost preference of user
   * @return list of attraction nodes of the given categories within a
   * box around the given positions
   */
  public static List&lt;AttractionNode&gt; findAttractionsBetween(

          double[] coords1, double[] coords2, List&lt;String&gt; categories, int prefNumStops, int costPref) {

<span class="fc" id="L48">    double[] boundingBoxBounds = findBoundingBoxBounds(coords1, coords2);</span>

<span class="fc" id="L50">    double[] expandedBoundingBoxBounds = expandBoundingBoxBounds(boundingBoxBounds, 2.0);</span>

    try {
<span class="fc" id="L53">      return findAttractionsWithinBoundingBox(expandedBoundingBoxBounds, categories, prefNumStops, costPref);</span>
<span class="nc" id="L54">    } catch (SQLException | IOException e) {</span>
<span class="nc" id="L55">      throw new IllegalArgumentException(&quot;ERROR: Error while connecting to SQL database&quot;);</span>
    }
  }

  /**
   * Finds the bounds for a bounding box to be created around the given coordinates.
   *
   * @param coords1 - [lat, lon] of the first position
   * @param coords2 - [lat, lon] of the second position
   * @return [start lat, end lat, start lon, end lon] of the bounding box
   */
  public static double[] findBoundingBoxBounds(double[] coords1, double[] coords2) {
<span class="fc" id="L67">    double[] bounds = new double[4];</span>

<span class="fc bfc" id="L69" title="All 2 branches covered.">    if (coords1[0] &lt; coords2[0]) {</span>
<span class="fc" id="L70">      bounds[0] = coords1[0];</span>
<span class="fc" id="L71">      bounds[1] = coords2[0];</span>
    } else {
<span class="fc" id="L73">      bounds[0] = coords2[0];</span>
<span class="fc" id="L74">      bounds[1] = coords1[0];</span>
    }

<span class="fc bfc" id="L77" title="All 2 branches covered.">    if (coords1[1] &lt; coords2[1]) {</span>
<span class="fc" id="L78">      bounds[2] = coords1[1];</span>
<span class="fc" id="L79">      bounds[3] = coords2[1];</span>
    } else {
<span class="fc" id="L81">      bounds[2] = coords2[1];</span>
<span class="fc" id="L82">      bounds[3] = coords1[1];</span>
    }

<span class="fc" id="L85">    return bounds;</span>
  }

  /**
   * Extends the given bounding box expansionFactor units in every direction.
   *
   * @param boundingBoxBounds - original bounding box to be expanded
   * @param expansionFactor - number of units to expand the bounding box by in every direction
   * @return [start lat, end lat, start lon, end lon] of the expanded bounding box
   */
  public static double[] expandBoundingBoxBounds(double[] boundingBoxBounds, double expansionFactor) {
<span class="fc" id="L96">    double[] expandedBoundingBoxBounds = new double[4];</span>

<span class="fc" id="L98">    expandedBoundingBoxBounds[0] = boundingBoxBounds[0] - expansionFactor;</span>
<span class="fc" id="L99">    expandedBoundingBoxBounds[1] = boundingBoxBounds[1] + expansionFactor;</span>
<span class="fc" id="L100">    expandedBoundingBoxBounds[2] = boundingBoxBounds[2] - expansionFactor;</span>
<span class="fc" id="L101">    expandedBoundingBoxBounds[3] = boundingBoxBounds[3] + expansionFactor;</span>

<span class="fc" id="L103">    return expandedBoundingBoxBounds;</span>
  }

  /**
   * Returns a list of all the attractions in the yelp database within the given
   * bounding box that are of the given categories.
   *
   * @param boundingBoxBounds - [start lat, end lat, start lon, end lon] of the bounding box
   * @param categories - list of acceptable attraction categories
   * @param prefNumStops - number of stops preferred by user
   * @param costPref - cost preference of user
   * @return list of attraction nodes of the given categories within the given bounding box
   * @throws SQLException - if yelp database cannot be successfully queried
   * @throws IOException - if issue with yelp API connection
   */
  public static List&lt;AttractionNode&gt; findAttractionsWithinBoundingBox(
          double[] boundingBoxBounds, List&lt;String&gt; categories, int prefNumStops, int costPref)
      throws SQLException, IOException {
<span class="fc" id="L121">    ArrayList&lt;String&gt; nameList = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L122">    Connection conn = Database.getYelpDatabaseConnection();</span>

<span class="fc" id="L124">    String query = &quot;SELECT * FROM yelp_business &quot; +</span>
            &quot;WHERE (latitude BETWEEN ? and ?) &quot; +
            &quot;AND (longitude BETWEEN ? AND ?)&quot; +
            &quot;AND (stars &gt; 3.0)&quot; +
            &quot;AND (review_count &gt; 10)&quot;;

<span class="fc" id="L130">    PreparedStatement prep = conn.prepareStatement(query);</span>
<span class="fc" id="L131">    prep.setDouble(1, boundingBoxBounds[0]);</span>
<span class="fc" id="L132">    prep.setDouble(2, boundingBoxBounds[1]);</span>
<span class="fc" id="L133">    prep.setDouble(3, boundingBoxBounds[2]);</span>
<span class="fc" id="L134">    prep.setDouble(4, boundingBoxBounds[3]);</span>

<span class="fc" id="L136">    ResultSet rs = prep.executeQuery();</span>
<span class="fc" id="L137">    List&lt;AttractionNode&gt; attractionsWithinBox = new ArrayList&lt;&gt;();</span>

<span class="fc bfc" id="L139" title="All 2 branches covered.">    while (rs.next()) {</span>
<span class="fc" id="L140">      String id = rs.getString(&quot;business_id&quot;);</span>
<span class="fc" id="L141">      String name = rs.getString(&quot;name&quot;);</span>
<span class="fc" id="L142">      nameList.add(name);</span>
<span class="fc" id="L143">      String address = rs.getString(&quot;address&quot;);</span>
<span class="fc" id="L144">      String city = rs.getString(&quot;city&quot;);</span>
<span class="fc" id="L145">      String state = rs.getString(&quot;state&quot;);</span>
<span class="fc" id="L146">      String postalCode = rs.getString(&quot;postal_code&quot;);</span>
<span class="fc" id="L147">      String[] location = new String[]{address, city, state, postalCode};</span>

<span class="fc" id="L149">      double lat = rs.getDouble(&quot;latitude&quot;);</span>
<span class="fc" id="L150">      double lon = rs.getDouble(&quot;longitude&quot;);</span>
<span class="fc" id="L151">      double[] coords = new double[]{lat, lon};</span>

<span class="fc" id="L153">      double price = 0.0;</span>
<span class="fc" id="L154">      double rating = rs.getDouble(&quot;stars&quot;);</span>

<span class="fc" id="L156">      double reviewCount = rs.getDouble(&quot;review_count&quot;);</span>

<span class="fc" id="L158">      String categoriesList = rs.getString(&quot;categories&quot;);</span>

<span class="fc bfc" id="L160" title="All 2 branches covered.">      if ((categoriesList.contains(&quot;Restaurants&quot;)</span>
<span class="fc bfc" id="L161" title="All 2 branches covered.">              || categoriesList.contains(&quot;Food&quot;)</span>
<span class="fc bfc" id="L162" title="All 2 branches covered.">              || categoriesList.contains(&quot;Bars&quot;))</span>
<span class="pc bpc" id="L163" title="1 of 2 branches missed.">              &amp;&amp; categories.contains(&quot;Restaurant&quot;)) {</span>
<span class="fc" id="L164">        Integer priceInt = findPriceField(rs.getString(&quot;attributes&quot;));</span>
<span class="fc bfc" id="L165" title="All 2 branches covered.">        if (priceInt != null) {</span>
<span class="fc" id="L166">          price = priceInt;</span>
<span class="fc" id="L167">          AttractionNode nextAttraction = new Restaurant(</span>
<span class="fc" id="L168">                  id, name, location, coords, price, rating, reviewCount);</span>
<span class="fc" id="L169">          attractionsWithinBox.add(nextAttraction);</span>
        }
<span class="pc bpc" id="L171" title="1 of 4 branches missed.">      } else if (categoriesList.contains(&quot;Museums&quot;) &amp;&amp; categories.contains(&quot;Museum&quot;)) {</span>
<span class="nc" id="L172">        AttractionNode nextAttraction = new Museum(</span>
                id, name, location, coords, price, rating, reviewCount);
<span class="nc" id="L174">        attractionsWithinBox.add(nextAttraction);</span>
<span class="pc bpc" id="L175" title="1 of 4 branches missed.">      } else if (categoriesList.contains(&quot;Parks&quot;) &amp;&amp; categories.contains(&quot;Park&quot;)) {</span>
<span class="fc" id="L176">        AttractionNode nextAttraction = new Park(</span>
            id, name, location, coords, price, rating, reviewCount);
<span class="fc" id="L178">        attractionsWithinBox.add(nextAttraction);</span>
<span class="pc bpc" id="L179" title="1 of 4 branches missed.">      } else if (categoriesList.contains(&quot;Shopping&quot;) &amp;&amp; categories.contains(&quot;Shop&quot;)) {</span>
<span class="nc" id="L180">        Integer priceInt = findPriceField(rs.getString(&quot;attributes&quot;));</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">        if (priceInt != null) {</span>
<span class="nc" id="L182">          price = priceInt;</span>
<span class="nc" id="L183">          AttractionNode nextAttraction = new Shop(</span>
<span class="nc" id="L184">                  id, name, location, coords, price, rating, reviewCount);</span>
<span class="nc" id="L185">          attractionsWithinBox.add(nextAttraction);</span>
        }
      }
<span class="fc" id="L188">    }</span>
<span class="fc" id="L189">    prep.close();</span>
<span class="fc" id="L190">    rs.close();</span>
<span class="fc" id="L191">    System.out.println(&quot;Length of attractions within bounding box is: &quot; + attractionsWithinBox.size());</span>

<span class="fc bfc" id="L193" title="All 2 branches covered.">    for (int i = 0; i &lt; (prefNumStops + 2); i++) {</span>
      //System.out.println(i);
<span class="fc" id="L195">      double reqLat = 0;</span>
<span class="fc" id="L196">      double reqLon = 0;</span>
      //start lat &gt; end lat
<span class="pc bpc" id="L198" title="1 of 2 branches missed.">      if (boundingBoxBounds[0] &gt; boundingBoxBounds[1]) {</span>
<span class="nc" id="L199">        reqLat = ((boundingBoxBounds[0] - boundingBoxBounds[1]) / (prefNumStops + 2)) * i +</span>
            boundingBoxBounds[1];
      } else {
<span class="fc" id="L202">        reqLat = ((boundingBoxBounds[1] - boundingBoxBounds[0]) / (prefNumStops + 2)) * i +</span>
            boundingBoxBounds[0];
      }
      //start lon &gt; end lon
<span class="pc bpc" id="L206" title="1 of 2 branches missed.">      if (boundingBoxBounds[2] &gt; boundingBoxBounds[3]) {</span>
<span class="nc" id="L207">        reqLon = ((boundingBoxBounds[2] - boundingBoxBounds[3]) / (prefNumStops + 2)) * i +</span>
            boundingBoxBounds[3];
      } else {
<span class="fc" id="L210">        reqLon = ((boundingBoxBounds[3] - boundingBoxBounds[2]) / (prefNumStops + 2)) * i +</span>
            boundingBoxBounds[2];
      }
<span class="fc" id="L213">      List&lt;AttractionNode&gt; nodes = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L214" title="1 of 2 branches missed.">      if (categories.contains(&quot;Restaurant&quot;)) {</span>
<span class="fc" id="L215">        List&lt;String&gt; param = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L216">        param.add(&quot;restaurant&quot;);</span>
<span class="fc" id="L217">        param.add(&quot;food&quot;);</span>
<span class="fc" id="L218">        param.add(&quot;bars&quot;);</span>
<span class="fc" id="L219">        URL url = new URL(</span>
            &quot;https://api.yelp.com/v3/businesses/search?latitude=&quot; + reqLat + &quot;&amp;longitude=&quot; +
                reqLon +
                &quot;&amp;categories=&quot; + &quot;\&quot;restaurant\&quot;,\&quot;food\&quot;,\&quot;bars\&quot;&quot; + &quot;&amp;price=&quot; + costPref);
<span class="fc" id="L223">        nodes = yelpUrlToAttractions(url, &quot;Restaurant&quot;);</span>
       // System.out.println(nodes.size() + &quot; many restaurants&quot;);
        //attractionsWithinBox.addAll(nodes);
      }
<span class="pc bpc" id="L227" title="1 of 2 branches missed.">      if (categories.contains(&quot;Shop&quot;)) {</span>
<span class="nc" id="L228">        URL url = new URL(</span>
            &quot;https://api.yelp.com/v3/businesses/search?latitude=&quot; + reqLat + &quot;&amp;longitude=&quot; + reqLon +
                &quot;&amp;categories=shoppingcenters&quot;);
<span class="nc" id="L231">        nodes = yelpUrlToAttractions(url, &quot;Shop&quot;);</span>
       // System.out.println(nodes.size() + &quot; many shops&quot;);
       // attractionsWithinBox.addAll(nodes);

      }
<span class="pc bpc" id="L236" title="1 of 2 branches missed.">      if (categories.contains(&quot;Museum&quot;)) {</span>
<span class="nc" id="L237">        URL url = new URL(</span>
            &quot;https://api.yelp.com/v3/businesses/search?latitude=&quot; + reqLat + &quot;&amp;longitude=&quot; + reqLon +
                &quot;&amp;categories=museums&quot;);
<span class="nc" id="L240">        nodes = yelpUrlToAttractions(url, &quot;Museum&quot;);</span>
       // System.out.println(nodes.size() + &quot; many museums&quot;);
       // attractionsWithinBox.addAll(nodes);
      }
<span class="pc bpc" id="L244" title="1 of 2 branches missed.">      if (categories.contains(&quot;Park&quot;)) {</span>
<span class="fc" id="L245">        URL url = new URL(</span>
            &quot;https://api.yelp.com/v3/businesses/search?latitude=&quot; + reqLat + &quot;&amp;longitude=&quot; + reqLon +
                &quot;&amp;categories=parks&quot;);
<span class="fc" id="L248">        nodes = yelpUrlToAttractions(url, &quot;Park&quot;);</span>
       // System.out.println(nodes.size() + &quot; many parks&quot;);
        //attractionsWithinBox.addAll(nodes);
      }
<span class="fc" id="L252">      List&lt;AttractionNode&gt; removeRepeats = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L253" title="All 2 branches covered.">      for(AttractionNode n: nodes){</span>
<span class="fc bfc" id="L254" title="All 2 branches covered.">        if (nameList.contains(n.getName())){</span>
<span class="fc" id="L255">          removeRepeats.add(n);</span>
<span class="fc" id="L256">          System.out.println(&quot;A repeat&quot;);</span>
        }
        else{
<span class="fc" id="L259">          nameList.add(n.getName());</span>
        }
<span class="fc" id="L261">      }</span>
<span class="fc" id="L262">      nodes.removeAll(removeRepeats);</span>
<span class="fc" id="L263">      attractionsWithinBox.addAll(nodes);</span>
    }
<span class="fc" id="L265">    System.out.println(&quot;The length of the list of attractions returned is: &quot; + attractionsWithinBox.size());</span>
<span class="fc" id="L266">    return attractionsWithinBox;</span>
  }

  /**
   * Helper class that takes in yelp url,
   * makes an API request,
   * and creates an attraction node accordingly.
   * @param yelpUrl yelp url to make API request from
   * @param attraction type of attraction we are making request for
   * @return list of attraction nodes, created from data from API call
   * @throws IOException occurs when failure from API call.
   */
  public static List&lt;AttractionNode&gt; yelpUrlToAttractions(URL yelpUrl, String attraction) throws IOException {
    //System.out.println(&quot;Attraction Parameter is: &quot; + attraction);
<span class="fc" id="L280">    HttpURLConnection con = (HttpURLConnection) yelpUrl.openConnection();</span>
<span class="fc" id="L281">    con.setRequestMethod(&quot;GET&quot;);</span>
<span class="fc" id="L282">    String yelpKey =</span>
        &quot;PlFxZHha-zmiQvrMQUb12P0uD9s_GZRJzzGZqVSJFKgR4iDXj1aBwOBuMc2DBFYkZODPw2V5PaJBMapJ5WA9PA3Lx2cGXq9FkzzT45m9t9I9gsXDdGCwQnuYu6J3YHYx&quot;;
<span class="fc" id="L284">    con.setRequestProperty(&quot;Authorization&quot;, &quot;Bearer &quot; + yelpKey);</span>
<span class="fc" id="L285">    BufferedReader in = null;</span>
<span class="fc" id="L286">    List&lt;AttractionNode&gt; attractions = new ArrayList&lt;&gt;();</span>
    try {
<span class="fc" id="L288">      in = new BufferedReader(new InputStreamReader(con.getInputStream()));</span>
<span class="fc" id="L289">      StringBuilder sb = new StringBuilder();</span>
      String line;
<span class="fc bfc" id="L291" title="All 2 branches covered.">      while ((line = in.readLine()) != null) {</span>
<span class="fc" id="L292">        sb.append(line);</span>
      }
<span class="fc" id="L294">      JSONObject json = new JSONObject(sb.toString());</span>
//      System.out.println(&quot;buffered reader&quot;);
//      System.out.println(json.getInt(&quot;total&quot;));
//      System.out.println(json.getJSONArray(&quot;businesses&quot;).toString());
//      System.out.println(&quot;Now Looping&quot;);
<span class="pc bpc" id="L299" title="1 of 2 branches missed.">      if (json.getInt(&quot;total&quot;) != 0) {</span>
<span class="fc bfc" id="L300" title="All 2 branches covered.">        for (int j = 0; j &lt; json.getInt(&quot;total&quot;); j++) {</span>
          try {
            //for each business create a json object to parse
<span class="fc" id="L303">            JSONObject businessJson = json.getJSONArray(&quot;businesses&quot;).getJSONObject(j);</span>
          //  System.out.println(json.getJSONArray(&quot;businesses&quot;).getString(j));

<span class="fc" id="L306">            String name = businessJson.get(&quot;name&quot;).toString();</span>
<span class="fc" id="L307">            String id = businessJson.get(&quot;id&quot;).toString();</span>
<span class="fc" id="L308">            JSONObject locationJson = businessJson.getJSONObject(&quot;location&quot;);</span>
            //location field is its own json object
<span class="fc" id="L310">            String[] loc = new String[]{locationJson.get(&quot;address1&quot;).toString(), locationJson.get(</span>
<span class="fc" id="L311">              &quot;city&quot;).toString(), locationJson.get(&quot;state&quot;).toString(),</span>
<span class="fc" id="L312">              locationJson.get(&quot;zip_code&quot;).toString()};</span>
<span class="fc" id="L313">            double[] coords = new double[]{businessJson.getJSONObject(&quot;coordinates&quot;).getDouble(</span>
<span class="fc" id="L314">              &quot;latitude&quot;), businessJson.getJSONObject(&quot;coordinates&quot;).getDouble(</span>
              &quot;longitude&quot;)};
            double price;
            try { //try catch for price because sometimes it isnt a field
<span class="fc" id="L318">              price = businessJson.get(&quot;price&quot;).toString().toCharArray().length;</span>
<span class="fc" id="L319">            } catch (JSONException e) {</span>
           //   System.out.println(&quot;no price&quot;);
<span class="fc" id="L321">              price = 0.0;</span>
<span class="fc" id="L322">            }</span>
<span class="fc" id="L323">            double rating = businessJson.getDouble(&quot;rating&quot;);</span>

<span class="fc" id="L325">            double reviewCount = businessJson.getDouble(&quot;review_count&quot;);</span>
           // System.out.println(&quot;Reviews Count: &quot; + reviewCount );
//            System.out.println(&quot;the name is : &quot; + name + &quot; id is: &quot; + id + &quot; location is: &quot; + loc[0] + &quot; &quot; + loc[1]
//              + &quot; coordinates are: &quot; + coords[0] + &quot; and &quot; + coords[1] + &quot; price is: &quot; + price + &quot; &quot; +
//              &quot;and&quot; +
//              &quot; rating &quot; +
//              &quot;is: &quot; + rating);
//            String category = businessJson.getJSONArray(&quot;categories&quot;).getJSONObject(0).getString(&quot;title&quot;);
          //  System.out.println(&quot;The category is: &quot; + category); //This is a specific category
            AttractionNode node;
<span class="pc bpc" id="L335" title="3 of 5 branches missed.">            switch(attraction){</span>
              case &quot;Park&quot;:
<span class="fc" id="L337">                node = new Park(id, name, loc, coords, price, rating, reviewCount);</span>
<span class="fc" id="L338">                break;</span>
              case &quot;Restaurant&quot;:
<span class="fc" id="L340">                node = new Restaurant(id, name, loc, coords, price, rating, reviewCount);</span>
<span class="fc" id="L341">                break;</span>
              case &quot;Museum&quot;:
<span class="nc" id="L343">                node = new Museum(id, name, loc, coords, price, rating, reviewCount);</span>
<span class="nc" id="L344">                break;</span>
              case &quot;Shop&quot;:
<span class="nc" id="L346">                node = new Shop(id, name, loc, coords, price, rating, reviewCount);</span>
<span class="nc" id="L347">                break;</span>
              default:
<span class="nc" id="L349">                node = null;</span>
                break;
            }
<span class="pc bpc" id="L352" title="1 of 2 branches missed.">            if (node!=null){</span>
<span class="fc" id="L353">              attractions.add(node);</span>
            }
          }
<span class="fc" id="L356">          catch (JSONException e){</span>
         //System.out.println(&quot;Json error&quot;);
<span class="fc" id="L358">          }</span>
          //THEN INSTANTIATE ATTRACTION NODE
          //attractions.add(attraction node)
        }
<span class="fc" id="L362">        return attractions;</span>
      }

<span class="fc" id="L365">    } catch (IOException | JSONException e) {</span>
<span class="fc" id="L366">      System.out.println(&quot;ERROR: failed to open input stream&quot;);</span>
<span class="fc" id="L367">      e.printStackTrace();</span>
<span class="nc" id="L368">    }</span>
<span class="fc" id="L369">  return attractions;</span>
  }

  public static Integer findPriceField(String attributes) {
<span class="fc" id="L373">    Integer price = null;</span>
<span class="fc bfc" id="L374" title="All 2 branches covered.">    if (attributes.contains(&quot;RestaurantsPriceRange2&quot;)) {</span>
<span class="fc" id="L375">      int startIndex = attributes.indexOf(&quot;RestaurantsPriceRange2&quot;);</span>
<span class="fc" id="L376">      int priceIndex = startIndex + 27;</span>
<span class="fc" id="L377">      String priceString = attributes.charAt(priceIndex) + &quot;&quot;;</span>
      try {
<span class="fc" id="L379">        price = Integer.parseInt(priceString);</span>
<span class="nc" id="L380">      } catch (Exception e) {</span>

<span class="fc" id="L382">      }</span>
    }
<span class="fc" id="L384">    return price;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>